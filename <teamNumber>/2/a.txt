CREATE TABLE TOTAL (DOC_ID INT,TOTAL INT,id INT AUTO_INCREMENT PRIMARY KEY)
INSERT INTO TOTAL (DOC_ID,TOTAL) SELECT I.DOC_ID,SUM(I.FREQ) FROM INVINDEX I GROUP BY I.DOC_ID
CREATE TABLE SCORE (WORD VARCHAR(225),DOC_ID INT ,SCORE FLOAT(24),id INT AUTO_INCREMENT PRIMARY KEY)
INSERT INTO SCORE (WORD,DOC_ID,SCORE) SELECT I.WORD,I.DOC_ID,(I.FREQ/T.TOTAL) FROM INVINDEX I INNER JOIN TOTAL T ON I.DOC_ID= T.DOC_ID
CREATE TOTAL_SCORE(DOC_ID INT,TOTAL_SCORE FLOAT(24),id INT AUTO_INCREMENT PRIMARY KEY)
INSERT INTO TOTAL_SCORE (DOC_ID,TOTAL_SCORE) SELECT S.DOC_ID SUM(S.SCORE) FROM SCORE S GROUP BY S.DOC_ID WHERE WORD = "Hello" or WORD = "World"
SELECT DOC_ID,TOTAL_SCORE FROM TOTAL_SCORE
